[miRe2e: a full end-to-end deep model based on transformers for prediction of pre-miRNAs](https://academic.oup.com/bioinformatics/article/38/5/1191/6454944?login=true)

## miRe2e: 基于Transformer的全端到端模型用于预测前体miRNA

### 1. 背景与研究目的
- miRNAs是小RNA序列，主要在不同生物体内的转录后基因表达调控中起关键作用。由于miRNAs与多种人类疾病的关系，准确预测新的miRNAs具有重要的生物学和医学意义。
- 当前的前体miRNA（pre-miRNA）预测模型通常依赖于特征工程，需先手动提取序列的二级结构（如茎环结构），再构建分类模型。然而，这些方法依赖于繁琐的预处理步骤，且性能受限。
- 本研究提出miRe2e，这是第一个用于pre-miRNA预测的全端到端深度学习（DL）模型，基于Transformers架构，自动学习并提取原始RNA序列中的相关结构特征，无需手动预处理。

### 2. 模型概述
- miRe2e模型是一个全端到端的Transformer模型，直接接收原始基因组序列作为输入，自动识别其中可能的pre-miRNA区域。
- 模型包含三个子模块：**结构预测模型**、**MFE估计模型**和**pre-miRNA分类器**，依次预测RNA序列的二级结构、计算最低自由能（MFE），并最终进行pre-miRNA的分类。

---

### 3. 数据预处理与输入数据结构
- **原始序列输入**：miRe2e接收的输入为原始基因组序列，分段为长度为L的短序列，并以滑动窗口（步长为s）进行扫描。
- **数据编码**：每个短序列以one-hot编码为 $L \times 4$ 的张量，每列分别代表4种核苷酸（A、C、G、U），用于输入Transformer模型。

---

### 4. 模型结构详解

#### 4.1 结构预测模型（Structure Prediction Model）
- **功能**：从RNA序列中自动预测二级结构。
- **架构**：
  - 输入的one-hot编码张量通过一个包含三层卷积神经网络（CNN）的网络，每层包含身份块（identity block），用于提取RNA序列中的关键特征。
  - CNN输出的嵌入向量加入位置编码信号，输入六个堆叠的Transformer编码器，每个编码器包含多头自注意力机制和前馈神经网络。
  - 最终通过一个三层多层感知器（MLP）生成RNA的二级结构表示，输出为 $L \times 1$ 的张量。
- **输入数据及生物学含义**：输入为one-hot编码的RNA序列，输出则为RNA的二级结构，包含茎环的位置信息，有助于区分pre-miRNA。
- **损失函数**：使用均方误差（MSE）损失函数，将预测的二级结构与参考二级结构（以0、1、-1编码的序列）进行比较。

#### 4.2 MFE估计模型（MFE Estimation Model）
- **功能**：根据输入序列及其预测的二级结构，估计最低自由能（Minimum Free Energy, MFE）。
- **架构**：
  - 将RNA序列和预测的二级结构合并为 $5 \times L$ 的张量（第五行为二级结构信息），输入到一个包含三层的CNN中，每层CNN后接一个池化层用于减少输入长度。
  - 最终通过一个三层MLP输出MFE估计值。
- **输入数据及生物学含义**：输入包含RNA序列和其预测的二级结构，输出MFE估计值。MFE值用于评估RNA结构的稳定性，对于pre-miRNA分类具有重要的鉴别作用。
- **损失函数**：同样采用均方误差（MSE）损失，预测的MFE值与RNAfold生成的参考MFE值进行比较。

#### 4.3 pre-miRNA分类器（pre-miRNA Classifier）
- **功能**：结合序列、二级结构和MFE估计值，最终判断输入序列是否为pre-miRNA。
- **架构**：
  - 该模型包含四层CNN和三个Transformer编码器层，每层编码器包含多头自注意力和前馈神经网络，最后输出一个嵌入表示。
  - 将嵌入表示和MFE估计值连接后通过四层MLP处理，输出一个预测类别（pre-miRNA或非pre-miRNA）。
- **输入数据及生物学含义**：输入包含RNA序列、二级结构信息和MFE估计值，这些特征共同用于判断是否为pre-miRNA。
- **损失函数**：使用softmax激活函数的交叉熵损失（Cross-Entropy Loss），用于区分pre-miRNA和非pre-miRNA序列。

---

### 5. 模型训练与损失函数
miRe2e模型在训练时采用分阶段的训练策略，以优化模型的预测效果。

1. **二级结构预测阶段**：先使用MSE损失训练结构预测模型，使其能够准确预测RNA序列的二级结构。
2. **MFE估计阶段**：将结构预测模型的输出传递给MFE估计模型，使用MSE损失训练，优化MFE预测精度。
3. **pre-miRNA分类阶段**：将前两个模型的输出传递给分类器，使用交叉熵损失进行训练，使其在大规模基因组数据上达到最佳分类性能。

---

### 6. 性能评估方法与实验结果
- **性能指标**：采用精确率（Precision）、召回率（Recall）和F1分数作为主要评估指标，另有PR曲线和AUCPR值用于评估分类器在高不平衡数据集下的全局性能。
- **实验结果**：miRe2e在高不平衡的人类基因组数据集上显著优于其他方法，如deepMir、mirDNN等。特别是在精确率和F1分数上，miRe2e表现出一到两个数量级的性能提升。
- **重要性分析**：通过消融实验分析，二级结构预测模块对模型的整体性能具有最重要的贡献，MFE估计模块也显著提升了分类器的性能。

---

### 7. 结论
- miRe2e模型是首个基于Transformer的全端到端pre-miRNA预测模型，能够从原始基因组序列自动提取相关特征，极大减少了手动特征工程的需求。
- 在高不平衡数据集上，miRe2e展示出极高的精确率和稳定性，可有效用于大规模基因组数据的pre-miRNA预测，为未来miRNA功能研究提供了有力工具。

